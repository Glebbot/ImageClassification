# Классификатор изображений
Универсальный классификатор изображений, содержит удобный интерфейс для выполнения предобработки данных, обучения нейронной сети и оценки её качества
## Входные данные
В качестве входных данных требуется датасет изображений, распределенных по классам. Каждый класс находится в своей директории. Изображения могут быть цветные, любого формата и размера
## Модели
В программе реализованы модели на основе ResNet18, EfficientNet из PyTorch lightning и собственной архитектуры сверточной нейронной сети. При этом интерфейс принимает любую подходящую для классификации изображений модель
## Интерфейс
Интерфейс работы с классификатором изображений представлен классом ImageClassifier. Класс инициализируется следующими параметрами:
1. model - используемая для классификации модель. По умолчанию: ResNet18
2. n_classes - количество классов в классификации. Параметр не является обязательным, так как может быть рассчитан автоматически если задан параметр classes. Если classes не задан, указывать n_classes обязательно
3. classes - массив названий классов в классификации, может быть указан вместо n_classes. Необходим для работы метода predict
4. device - устройство, изпользуемое для обучения нейросети. По умолчанию: gpu если доступно, иначе cpu
5. image_folder_path - путь к папке с датасетом. Параметр не является обязательным, так как может быть задан непосредственно при вызове метода fit
6. absolute_path - флаг, является ли путь к папке с датасетом абсолютным (True) или относительным (False). По умолчанию: False
7. batch_size - размер батчей, используемых для обучения модели. По умолчанию: 64
8. shuffle_test - флаг, требуется ли перемешивать тестовую выборку. По умолчанмю: False
9. test_size - размер тестовой выборки (доля). По умолчанию: 0.2
10. image_resize - размер, к которому будут приведены все изображения (в виде пары чисел). По умолчанмю: (64, 64)
11. validation_size - размер валидационной выборки (доля). По умолчанию: 0.05
12. mean - математическое ожидание значений каналов RGB в датасете. Необходимо для нормализации. По умолчанию: [0.5, 0.5, 0.5]
13. std - дисперсия значений каналов RGB в датасете. Необходимо для нормализации. По умолчанию: [0.25, 0.25, 0.25]
14. normalize_calc - флаг, выполнять ли автоматический подсчет мат. ожидания и дисперсии по заданному датасету. Подсчет может занимать много времени. В случае если установлено True подсчитанные значения будут использованы вместо значений параметров mean, std. По умолчанию: True
    
## Методы
При инициализации класса (если задан путь к датасету) создаются объекты DataLoader для тренировочной тестовой и валидационной выборок. Дальнейшая работа осуществляется следующими методами:
1. fit - обучить модель. Параметры: train_loader - тренировочный DataLoader (по умолчанию используется созданный при инициализации класса), validation_loader - валидационный DataLoader (по умолчанию используется созданный при инициализации класса), epochs - количество эпох обучения (по умолчанию: 10), learning_rate - темп обучения (по умолчанию: 0.001), validation - флаг, проводить ли валидацию при обучении (по умолчанию: True)
2. accuracy_score - рассчитать точность предсказаний на тестовом датасете. Параметры: test_loader - тестовый DataLoader (по умолчанию используется созданный при инициализации класса), size - сколько элементов выборки брать для оценки точности (по умолчанию: вся выборка)
3. save - сохранить обученную модель в файле. Параметры: path - путь к файлу
4. load - загрузить обученную модель из файла. Параметры: path - путь к файлу
5. predict - Вывести предсказания модели для элементов тестового датасета, вывести их реальные метки классов и сами изображения. Для работы метода необходимо задать при инициализации classes - список меток классов. Параметры: test_loader - тестовый DataLoader (по умолчанию используется созданный при инициализации класса), size - сколько элементов выборки выводить (по умолчанию: 4)
## Оценка
Оценка проводилась на трех датасетах:
1. Искаженный MNIST - стандартный датасет MNIST с рукописными цифрами, которые были дополнительно искажены для усложения классификации. Точность при использовании для классификации собственной архитектуры сверточной нейросети (3 слоя): 0.94
2. Cats and dogs - датасет с изображениями кошек и собак. Точность: 0.85
3. Vechicles - датасет с изображениями 6 видов транспортных средств: автомобиль, самолет, лодка, грузовик, мотоцикл, автобус. Точность при использовании ResNet: 0.81
<br>
Нейросети обучались на небольшом количестве эпох (10-25), при увеличении их числа могут быть достигнуты лучшие результаты
